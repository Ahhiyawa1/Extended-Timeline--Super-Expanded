etf_startup = {
	# Following effects only fire once on first-time setup:
	if = {
		limit = {
			NOT = { has_global_flag = etf_setup_global }
		}
		set_global_flag = etf_setup_global
		
		# Country Setup
		every_country = {
			limit = {
				exists = yes
			}
			# Politics
			calculate_total_industry_score = yes
			# capital_scope = {
				# add_province_modifier = {
					# name = seat_of_government_modifier # Displays Industry Score + Other Stuff
					# duration = -1
				# }
			# }
			country_event = { id = etf_political.901 } # Political Faction Influence Setup
			regenerate_government_mechanics = yes
			if = {
				limit = {
					is_democracy = no
					NOT = { has_ruler_flag = ruler_from_conservative_party }
					NOT = { has_ruler_flag = ruler_from_liberal_party }
					NOT = { has_ruler_flag = ruler_from_nationalist_party }
					NOT = { has_ruler_flag = ruler_from_social_democratic_party }
					NOT = { has_ruler_flag = ruler_from_communist_party }
					NOT = { has_ruler_flag = ruler_from_national_socialist_party }
				}
				if = {
					limit = {
						is_communist = yes
					}
					set_ruler_flag = ruler_from_communist_party
				}
				else_if = {
					limit = {
						is_fascist = yes
					}
					set_ruler_flag = ruler_from_national_socialist_party
				}
			}
			# Opinion
			ideology_opinion_effect = yes
			every_country = {
				limit = {
					has_opinion_modifier = {
						modifier = had_war_with_us
						who = PREV
					}
				}
				remove_opinion = {
					modifier = had_war_with_us
					who = PREV
				}
			}
			every_country = {
				limit = {
					reverse_has_opinion_modifier = {
						modifier = had_war_with_us
						who = PREV
					}
				}
				reverse_remove_opinion = {
					modifier = had_war_with_us
					who = PREV
				}
			}
			# Demilitarize Nations
			if = {
				limit = {
					has_country_modifier = no_army
					is_at_war = no
				}
				disband_all_units = yes
				add_manpower = -50
				add_sailors = -50000
			}
			# Republican Tradition
			if = {
				limit = {
					uses_republican_tradition = yes
				}
				trigger_switch = { # Political System:
					on_trigger = has_reform
					two_party_system = {
						add_republican_tradition = -10
					}
					single_party_system = {
						add_republican_tradition = -20
					}
					dictatorial_rule = {
						add_republican_tradition = -25
					}
					totalitarian_rule = {
						add_republican_tradition = -30
					}
					colonial_oppression_system = {
						add_republican_tradition = -25
					}
				}
				trigger_switch = { # Ideology:
					on_trigger = has_reform
					oligarchic_reform = {
						add_republican_tradition = -20
					}
					military_government = {
						add_republican_tradition = -40
					}
					communist_government = {
						add_republican_tradition = -30
					}
					fascist_government = {
						add_republican_tradition = -50
					}
					islamist_government = {
						add_republican_tradition = -40
					}
				}
			}
			# Starting colonies turn into cities
			every_owned_province = {
				limit = {
					is_city = no
				}
				kill_units = { who = NAT }
				decolonize = yes
				cede_province = PREV
			}
		}
		# Non-Existant Country Setup
		every_country_including_inactive = {
			limit = {
				capital_scope = {}
				exists = no
			}
			country_event = { id = etf_dynamic_countries.1 } # Update tag/name
		}
		# Add Trade Companies
		every_province = {
			limit = {
				is_node_in_trade_company_region = yes
				is_owned_by_trade_company = no
				
				is_overseas = yes
				NOT = { culture_group = owner }
			}
			remove_core = owner
			add_territorial_core = owner
			add_to_trade_company = owner
		}
		# Add Missing Cores
		every_province = {
			limit = {
				NOT = { is_core = owner }
			}
			if = {
				limit = {
					is_state = yes
				}
				add_core = owner
			}
			else = {
				add_territorial_core = owner
			}
		}
		# Add Industry
		every_province = {
			limit = {
				development = 10
			}
			if = {
				limit = {
					has_farm_trade_goods = yes
					owner = {
						adm_tech = 51
					}
				}
				add_building = farm_estate
			}
			else_if = {
				limit = {
					has_textile_trade_goods = yes
					owner = {
						adm_tech = 56
					}
				}
				add_building = textile
			}
			else_if = {
				limit = {
					has_wharf_trade_goods = yes
					owner = {
						dip_tech = 56
					}
				}
				add_building = wharf
			}
			else_if = {
				limit = {
					has_weapons_trade_goods = yes
					owner = {
						mil_tech = 56
					}
				}
				add_building = weapons
			}
			else_if = {
				limit = {
					has_plantation_trade_goods = yes
					owner = {
						adm_tech = 59
					}
				}
				add_building = plantations
			}
			else_if = {
				limit = {
					has_trade_company_trade_goods = yes
					owner = {
						dip_tech = 59
					}
				}
				add_building = tradecompany
			}
			else_if = {
				limit = {
					has_mills_trade_goods = yes
					owner = {
						adm_tech = 61
					}
				}
				add_building = mills
			}
			else_if = {
				limit = {
					OR = {
						trade_goods = coal
						trade_goods = oil
						trade_goods = uranium
						trade_goods = aluminum
						trade_goods = electronics
						trade_goods = cars
					}
					owner = {
						adm_tech = 66
					}
				}
				add_building = furnace
			}
			if = {
				limit = {
					is_year = 1850
					OR = {
						AND = {
							development = 15
							OR = {
								continent = europe
								continent = north_america
								continent = oceania
							}
						}
						AND = {
							development = 30
							OR = {
								continent = africa
								continent = asia
								continent = south_america
							}
							NOT = { superregion = china_superregion }
						}
						AND = {
							development = 45
							superregion = china_superregion
						}
					}
					is_state_core = owner
					industrialization = 100
					owner = {
						adm_tech = 77
					}
				}
				add_building_factory = { development = yes }
			}
		}
		
		# Congress of Vienna:
		# -------------------
		if = {
			limit = {
				started_in = 1815.6.9
				NOT = { is_year = 1900 }
			}
			# Makes AI rulers more 'civil'
			every_country = {
				limit = {
					ai = yes
					capital_scope = {
						continent = europe
					}
				}
				set_ai_personality = {
					personality = ai_diplomat
					locked = yes # Lasts until ruler death
				}
			}
		}
		
		# Victorian Era:
		# --------------
		if = {
			limit = {
				is_year = 1836
			}
			# General
			every_country = {
				limit = {
					exists = yes
				}
				add_years_of_income = 0.5 # Starting capital
				discover_the_world_effect = yes # Remove Terra Incognito
				etf_oob_effect = yes # "oob" trims starting armies to be less random
				every_subject_country = {
					limit = {
						OR = {
							is_colonial_subject_type = yes
							is_protectorate_subject_type = yes
							is_subject_of_type = dominion
						}
					}
					# Give starting opinion boost with colonial subjects
					add_100_opinion_effect = {
						who = overlord
						mutual = yes
					}
				}
			}
			# Troops
			if = {
				limit = {
					NOT = { is_year = 1900 }
				}
				GBR = { # (Make Britain look scarier)
					234 = { # Hampshire
						create_army = {
							infantry = 25
							cavalry = 5
							artillery = 5
						}
					}
					235 = { # Kent
						create_army = {
							infantry = 25
							cavalry = 5
							artillery = 5
						}
					}
					4373 = { # Devon
						create_army = {
							infantry = 25
							cavalry = 5
							artillery = 5
						}
					}
				}
			}
		}
		
		# Great War Age:
		# --------------
		if = {
			limit = {
				is_year = 1914
				# NOT = { is_year = 1945 }
			}
			# Adds free military regiments to borders shared with enemy nations.
			every_country = {
				limit = {
					is_at_war = yes
				}
				country_event = { id = etf_event.105 }
			}
		}
		
		# Interwar Period/WW2:
		# --------------------
		if = {
			limit = {
				is_year = 1936
				NOT = { is_year = 1945 }
			}
			every_country = {
				limit = {
					exists = yes
				}
				add_absolutism = 100
				add_country_modifier = {
					name = ww2_total_war
					duration = -1
					hidden = yes
				}
				every_subject_country = {
					limit = {
						is_subject_other_than_tributary_trigger = yes
					}
					add_liberty_desire = -100
				}
				# set_country_flag = provinces_should_flip
			}
			random_country = {
				limit = {
					country_is = { tag = ITA }
				}
				every_province = {
					limit = {
						owned_by = ETH
					}
					add_claim = PREV
				}
			}
			set_global_flag = interwar_calm
		}
	}
	# Following effects only fire AFTER first-time setup:
	else_if = {
		limit = {
			had_global_flag = {
				flag = etf_setup_global
				days = 1
			}
			OR = { # should only fire ONCE per session
				NOT = {
					has_global_flag = etf_subsequent_setup_global
				}
				had_global_flag = {
					flag = etf_subsequent_setup_global
					days = 1
				}
			}
		}
		clr_global_flag = etf_subsequent_setup_global
		set_global_flag = etf_subsequent_setup_global
		
		# Updates:
		update_country_tag_alias_list = yes
		1 = {
			change_variable = { # init, if it doesn't exist
				which = etf_mod_version
				value = 0
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 57 }
					}
				}
			}
			every_country_including_inactive = { # This mechanic is now legacy:
				limit = {
					capital_scope = {}
					has_country_flag = has_custom_government_name
				}
				restore_country_name = yes
				clr_country_flag = has_custom_government_name
			}
			REB = {
				if = { limit = { NOT = { has_saved_global_event_target = GP_1  } } save_global_event_target_as = GP_1  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_2  } } save_global_event_target_as = GP_2  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_3  } } save_global_event_target_as = GP_3  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_4  } } save_global_event_target_as = GP_4  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_5  } } save_global_event_target_as = GP_5  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_6  } } save_global_event_target_as = GP_6  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_7  } } save_global_event_target_as = GP_7  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_8  } } save_global_event_target_as = GP_8  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_9  } } save_global_event_target_as = GP_9  }
				if = { limit = { NOT = { has_saved_global_event_target = GP_10 } } save_global_event_target_as = GP_10 }
				if = { limit = { NOT = { has_saved_global_event_target = GP_11 } } save_global_event_target_as = GP_11 }
				if = { limit = { NOT = { has_saved_global_event_target = GP_12 } } save_global_event_target_as = GP_12 }
				if = { limit = { NOT = { has_saved_global_event_target = GP_13 } } save_global_event_target_as = GP_13 }
				if = { limit = { NOT = { has_saved_global_event_target = GP_14 } } save_global_event_target_as = GP_14 }
				if = { limit = { NOT = { has_saved_global_event_target = GP_15 } } save_global_event_target_as = GP_15 }
				if = { limit = { NOT = { has_saved_global_event_target = GP_16 } } save_global_event_target_as = GP_16 }
			}
			update_diplomatic_influence_system = yes
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 60 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
					has_government_attribute = has_prime_minister
					NOT = { has_country_flag = ruler_is_prime_minister }
				}
				set_country_flag = ruler_is_prime_minister
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 61 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
					country_name_is = { name = KALMAR_UNION }
				}
				clear_country_name_with_flag = { name = KALMAR_UNION }
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 62 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				# Remove legacy dynamic names:
				clear_country_name_with_flag = { name = ABK_communism }
				clear_country_name_with_flag = { name = ABK_fascism }
				clear_country_name_with_flag = { name = ABK_SOV_subject }
				clear_country_name_with_flag = { name = AFG_empire }
				clear_country_name_with_flag = { name = AGL_fascism }
				clear_country_name_with_flag = { name = ALN_SOV_subject }
				clear_country_name_with_flag = { name = ARB_Sa'ud_dynasty }
				clear_country_name_with_flag = { name = ARB_empire }
				clear_country_name_with_flag = { name = ARM_SOV_subject }
				clear_country_name_with_flag = { name = AZE_SOV_subject }
				clear_country_name_with_flag = { name = BLP_SOV_subject }
				clear_country_name_with_flag = { name = BLR_SOV_subject }
				clear_country_name_with_flag = { name = BRT_SOV_subject }
				clear_country_name_with_flag = { name = BRZ_empire }
				clear_country_name_with_flag = { name = BSH_SOV_subject }
				clear_country_name_with_flag = { name = BUK_fascism }
				clear_country_name_with_flag = { name = BUK_SOV_subject }
				clear_country_name_with_flag = { name = BYZ_empire }
				clear_country_name_with_flag = { name = CAF_empire }
				clear_country_name_with_flag = { name = CDD_fascism }
				clear_country_name_with_flag = { name = CEH_SOV_subject }
				clear_country_name_with_flag = { name = CHO_USA_subject }
				clear_country_name_with_flag = { name = COL_fascism }
				clear_country_name_with_flag = { name = CRI_SOV_subject }
				clear_country_name_with_flag = { name = CRO_monarchy }
				clear_country_name_with_flag = { name = CSA_empire }
				clear_country_name_with_flag = { name = DAG_SOV_subject }
				clear_country_name_with_flag = { name = DRI_empire }
				clear_country_name_with_flag = { name = DRP_FRA_subject }
				clear_country_name_with_flag = { name = ECU_fascism }
				clear_country_name_with_flag = { name = EGY_communism }
				clear_country_name_with_flag = { name = EGY_fascism }
				clear_country_name_with_flag = { name = EIC_empire }
				clear_country_name_with_flag = { name = EST_SOV_subject }
				clear_country_name_with_flag = { name = EUR_empire }
				clear_country_name_with_flag = { name = FEN_dictatorship }
				clear_country_name_with_flag = { name = FIN_SOV_subject }
				clear_country_name_with_flag = { name = FRA_empire }
				clear_country_name_with_flag = { name = GAZ_republic }
				clear_country_name_with_flag = { name = GBR_empire }
				clear_country_name_with_flag = { name = GEO_SOV_subject }
				clear_country_name_with_flag = { name = GER_empire }
				clear_country_name_with_flag = { name = GTM_communism }
				clear_country_name_with_flag = { name = GTM_fascism }
				clear_country_name_with_flag = { name = HAF_republic }
				clear_country_name_with_flag = { name = HAT_empire }
				clear_country_name_with_flag = { name = HON_fascism }
				clear_country_name_with_flag = { name = IBU_empire }
				clear_country_name_with_flag = { name = INI_fascism }
				clear_country_name_with_flag = { name = IRQ_fascism }
				clear_country_name_with_flag = { name = ISS_empire }
				clear_country_name_with_flag = { name = IVO_fascism }
				clear_country_name_with_flag = { name = JAP_TKG_subject }
				clear_country_name_with_flag = { name = JMC_fascism }
				clear_country_name_with_flag = { name = JMN_empire }
				clear_country_name_with_flag = { name = KGO_GER_subject }
				clear_country_name_with_flag = { name = KHA_fascism }
				clear_country_name_with_flag = { name = KHI_SOV_subject }
				clear_country_name_with_flag = { name = KLM_SOV_subject }
				clear_country_name_with_flag = { name = KOE_empire }
				clear_country_name_with_flag = { name = KOI_empire }
				clear_country_name_with_flag = { name = KRL_fascism }
				clear_country_name_with_flag = { name = KRL_SOV_subject }
				clear_country_name_with_flag = { name = KRY_SOV_subject }
				clear_country_name_with_flag = { name = KYR_fascism }
				clear_country_name_with_flag = { name = KYR_SOV_subject }
				clear_country_name_with_flag = { name = KZK_fascism }
				clear_country_name_with_flag = { name = KZK_SOV_subject }
				clear_country_name_with_flag = { name = LEB_monarchy }
				clear_country_name_with_flag = { name = LIT_SOV_subject }
				clear_country_name_with_flag = { name = LTV_SOV_subject }
				clear_country_name_with_flag = { name = MAC_empire }
				clear_country_name_with_flag = { name = MAR_empire }
				clear_country_name_with_flag = { name = MDG_monarchy }
				clear_country_name_with_flag = { name = MDV_SOV_subject }
				clear_country_name_with_flag = { name = MEX_democratic }
				clear_country_name_with_flag = { name = MLO_monarchy }
				clear_country_name_with_flag = { name = MNG_empire }
				clear_country_name_with_flag = { name = MOR_empire }
				clear_country_name_with_flag = { name = MUG_empire }
				clear_country_name_with_flag = { name = MVA_empire }
				clear_country_name_with_flag = { name = NKC_SOV_subject }
				clear_country_name_with_flag = { name = NOK_empire }
				clear_country_name_with_flag = { name = NPL_empire }
				clear_country_name_with_flag = { name = NZL_empire }
				clear_country_name_with_flag = { name = OMA_empire }
				clear_country_name_with_flag = { name = PAK_empire }
				clear_country_name_with_flag = { name = PAP_ITA_subject }
				clear_country_name_with_flag = { name = PHI_communism }
				clear_country_name_with_flag = { name = PHI_fascism }
				clear_country_name_with_flag = { name = POZ_PRU_subject }
				clear_country_name_with_flag = { name = POZ_NGC_subject }
				clear_country_name_with_flag = { name = POZ_GER_subject }
				clear_country_name_with_flag = { name = PUN_empire }
				clear_country_name_with_flag = { name = PUR_fascism }
				clear_country_name_with_flag = { name = QNG_empire }
				clear_country_name_with_flag = { name = ROM_empire }
				clear_country_name_with_flag = { name = RUS_SOV_subject }
				clear_country_name_with_flag = { name = SAU_empire }
				clear_country_name_with_flag = { name = SCA_danish_culture }
				clear_country_name_with_flag = { name = SER_empire }
				clear_country_name_with_flag = { name = SLM_empire }
				clear_country_name_with_flag = { name = SOF_empire }
				clear_country_name_with_flag = { name = SPA_empire }
				clear_country_name_with_flag = { name = SUD_fascism }
				clear_country_name_with_flag = { name = SWI_empire }
				clear_country_name_with_flag = { name = TAS_GBR_subject }
				clear_country_name_with_flag = { name = TAS_GBR_dominion }
				clear_country_name_with_flag = { name = TAT_SOV_subject }
				clear_country_name_with_flag = { name = TCC_SOV_subject }
				clear_country_name_with_flag = { name = TIB_empire }
				clear_country_name_with_flag = { name = TJK_fascism }
				clear_country_name_with_flag = { name = TJK_SOV_subject }
				clear_country_name_with_flag = { name = TNZ_monarchy }
				clear_country_name_with_flag = { name = TOG_empire }
				clear_country_name_with_flag = { name = TPG_empire }
				clear_country_name_with_flag = { name = TPG_republic }
				clear_country_name_with_flag = { name = TPG_theocracy }
				clear_country_name_with_flag = { name = TRK_SOV_subject }
				clear_country_name_with_flag = { name = TTU_republic }
				clear_country_name_with_flag = { name = TTU_communism }
				clear_country_name_with_flag = { name = TUR_empire }
				clear_country_name_with_flag = { name = UCA_republic }
				clear_country_name_with_flag = { name = UCA_GBR_subject }
				clear_country_name_with_flag = { name = UDM_SOV_subject }
				clear_country_name_with_flag = { name = UHW_empire }
				clear_country_name_with_flag = { name = UKR_SOV_subject }
				clear_country_name_with_flag = { name = USA_GBR_subject }
				clear_country_name_with_flag = { name = UZB_SOV_subject }
				clear_country_name_with_flag = { name = VIC_republic }
				clear_country_name_with_flag = { name = VIC_GBR_subject }
				clear_country_name_with_flag = { name = VTN_empire }
				clear_country_name_with_flag = { name = WRO_GER_subject }
				clear_country_name_with_flag = { name = YKU_SOV_subject }
				clear_country_name_with_flag = { name = YUA_empire }
				# Remove Welfare Reforms:
				remove_country_modifier = healthcare_simple_modifier
				remove_country_modifier = healthcare_mediocre_modifier
				remove_country_modifier = healthcare_great_modifier
				
				remove_country_modifier = education_simple_modifier
				remove_country_modifier = education_mediocre_modifier
				remove_country_modifier = education_great_modifier
				
				remove_country_modifier = min_wage_simple_modifier
				remove_country_modifier = min_wage_mediocre_modifier
				remove_country_modifier = min_wage_great_modifier
				
				remove_country_modifier = unions_simple_modifier
				remove_country_modifier = unions_mediocre_modifier
				remove_country_modifier = unions_great_modifier
				
				remove_country_modifier = work_c_simple_modifier
				remove_country_modifier = work_c_mediocre_modifier
				remove_country_modifier = work_c_great_modifier
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 64 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = BRM_Konbaung_dynasty }
				clear_country_name_with_flag = { name = BRM_Taungu_dynasty }
				clear_country_name_with_flag = { name = BRM_fascism }
				clear_country_name_with_flag = { name = BRM_communism }
				clear_country_name_with_flag = { name = UZB_RUS_vassal }
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 65 }
					}
				}
			}
			if = {
				limit = {
					exists = RAJ
					RAJ = {
						is_subject_of_type = colonial_dependency
					}
				}
				RAJ = {
					change_tag = RHJ
				}
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 67 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = ABK_SOV_communism_subject }
				clear_country_name_with_flag = { name = ALN_SOV_communism_subject }
				clear_country_name_with_flag = { name = ARM_SOV_communism_subject }
				clear_country_name_with_flag = { name = ATB_von_Wettin_dynasty }
				clear_country_name_with_flag = { name = AZE_SOV_communism_subject }
				clear_country_name_with_flag = { name = BLP_SOV_communism_subject }
				clear_country_name_with_flag = { name = BLR_SOV_communism_subject }
				clear_country_name_with_flag = { name = BOS_fascism }
				clear_country_name_with_flag = { name = BRT_SOV_communism_subject }
				clear_country_name_with_flag = { name = BRZ_dictatorship }
				clear_country_name_with_flag = { name = BSH_SOV_communism_subject }
				clear_country_name_with_flag = { name = BUK_SOV_communism_subject }
				clear_country_name_with_flag = { name = CAN_fascism }
				clear_country_name_with_flag = { name = CCS_SOV_communism_subject }
				clear_country_name_with_flag = { name = CEH_SOV_communism_subject }
				clear_country_name_with_flag = { name = CEY_GBR_dominion }
				clear_country_name_with_flag = { name = COB_von_Wettin_dynasty }
				clear_country_name_with_flag = { name = CRI_SOV_communism_subject }
				clear_country_name_with_flag = { name = DAG_SOV_communism_subject }
				clear_country_name_with_flag = { name = DAG_theocracy }
				clear_country_name_with_flag = { name = EST_SOV_communism_subject }
				clear_country_name_with_flag = { name = FIN_SOV_communism_subject }
				clear_country_name_with_flag = { name = GEO_SOV_communism_subject }
				clear_country_name_with_flag = { name = KHI_SOV_communism_subject }
				clear_country_name_with_flag = { name = KKP_SOV_communism_subject }
				clear_country_name_with_flag = { name = KLM_SOV_communism_subject }
				clear_country_name_with_flag = { name = KOE_empire_monarchy }
				clear_country_name_with_flag = { name = KRD_SOV_communism_subject }
				clear_country_name_with_flag = { name = KRK_republic }
				clear_country_name_with_flag = { name = KRL_SOV_communism_subject }
				clear_country_name_with_flag = { name = KRY_SOV_communism_subject }
				clear_country_name_with_flag = { name = KYR_SOV_communism_subject }
				clear_country_name_with_flag = { name = KZK_RUS_vassal }
				clear_country_name_with_flag = { name = KZK_SOV_communism_subject }
				clear_country_name_with_flag = { name = LIT_SOV_communism_subject }
				clear_country_name_with_flag = { name = LTV_SOV_communism_subject }
				clear_country_name_with_flag = { name = MA0_SOV_communism_subject }
				clear_country_name_with_flag = { name = MDV_SOV_communism_subject }
				clear_country_name_with_flag = { name = MEX_democratic_republic }
				clear_country_name_with_flag = { name = MIG_von_Wettin_dynasty }
				clear_country_name_with_flag = { name = MSA_GBR_colonial_dependency }
				clear_country_name_with_flag = { name = NKC_SOV_communism_subject }
				clear_country_name_with_flag = { name = PHI_SPA_colonial_dependency }
				clear_country_name_with_flag = { name = RJP_GBR_subject }
				clear_country_name_with_flag = { name = TAT_SOV_communism_subject }
				clear_country_name_with_flag = { name = TCC_SOV_communism_subject }
				clear_country_name_with_flag = { name = TJK_SOV_communism_subject }
				clear_country_name_with_flag = { name = TRK_RUS_vassal }
				clear_country_name_with_flag = { name = TRK_SOV_communism_subject }
				clear_country_name_with_flag = { name = TRK_fascism }
				clear_country_name_with_flag = { name = UDM_SOV_communism_subject }
				clear_country_name_with_flag = { name = UKR_SOV_communism_subject }
				clear_country_name_with_flag = { name = UZB_SOV_communism_subject }
				clear_country_name_with_flag = { name = VEN_revolutionary }
				clear_country_name_with_flag = { name = VIC_revolutionary }
				clear_country_name_with_flag = { name = VTN_FRA_vassal }
				clear_country_name_with_flag = { name = WMA_von_Wettin_dynasty }
				clear_country_name_with_flag = { name = YKU_SOV_communism_subject }
				
				update_main_religion_variable_effect = yes
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 70 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = CRO_HUN_monarchy_subject }
				clear_country_name_with_flag = { name = SGA_monarchy }
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 72 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = MAJ_republic }
				clear_country_name_with_flag = { name = MKS_republic }
				
				if = {
					limit = {
						government = theocracy
						has_reform = islamic_republic_reform
					}
					remove_government_reform = islamic_republic_reform
				}
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 73 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = ION_GBR_subject }
				clear_country_name_with_flag = { name = ION_republic }
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 74 }
					}
				}
			}
			every_province = {
				remove_province_modifier = seat_of_government_modifier
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = DOM_monarchy }
				clear_country_name_with_flag = { name = EZO_republic }
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 75 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = AFG_fascism }
				clear_country_name_with_flag = { name = AHU_communism }
				clear_country_name_with_flag = { name = AHU_republic }
				clear_country_name_with_flag = { name = ALA_USA_subject }
				clear_country_name_with_flag = { name = BHM_fascism }
				clear_country_name_with_flag = { name = BHM_communism }
				clear_country_name_with_flag = { name = BOL_fascism }
				clear_country_name_with_flag = { name = BOL_communism }
				clear_country_name_with_flag = { name = DGL_communism }
				clear_country_name_with_flag = { name = DRI_fascism }
				clear_country_name_with_flag = { name = DRI_communism }
				clear_country_name_with_flag = { name = DRI_republic }
				clear_country_name_with_flag = { name = EST_fascism }
				clear_country_name_with_flag = { name = HRZ_fascism }
				clear_country_name_with_flag = { name = IRE_fascism }
				clear_country_name_with_flag = { name = IVO_communism }
				clear_country_name_with_flag = { name = KRE_fascism }
				clear_country_name_with_flag = { name = LAP_republic }
				clear_country_name_with_flag = { name = LBR_fascism }
				clear_country_name_with_flag = { name = LBR_communism }
				clear_country_name_with_flag = { name = LIT_fascism }
				clear_country_name_with_flag = { name = LTV_fascism }
				clear_country_name_with_flag = { name = MKL_communism }
				clear_country_name_with_flag = { name = PLS_fascism }
				clear_country_name_with_flag = { name = PLS_communism }
				clear_country_name_with_flag = { name = PUR_USA_subject }
				clear_country_name_with_flag = { name = SHL_fascism }
				clear_country_name_with_flag = { name = TIB_communism }
				clear_country_name_with_flag = { name = ZAN_republic }
			}
		}
		if = {
			limit = {
				1 = {
					NOT = {
						check_variable = { which = etf_mod_version value = 76 }
					}
				}
			}
			every_country_including_inactive = {
				limit = {
					capital_scope = {}
				}
				clear_country_name_with_flag = { name = KHN_GBR_subject }
				clear_country_name_with_flag = { name = ODH_GBR_subject }
			}
		}
	}
	
	# Update current version number:
	1 = {
		if = {
			limit = {
				NOT = {
					check_variable = {
						which = etf_mod_version
						value = 78
					}
				}
			}
			set_variable = {
				which = etf_mod_version
				value = 78
			}
			log = "Extended Flavor Mod: Version 78"
		}
	}
}

discover_the_world_effect = {
	custom_tooltip = discover_the_world_effect_tt
	hidden_effect = {
		save_event_target_as = root_scope
		
		every_province = {
			discover_country = event_target:root_scope
			# Including lakes:
			every_neighbor_sea_zone = {
				discover_country = event_target:root_scope
			}
			# The seas:
			sea_zone = {
				region = {
					discover_country = event_target:root_scope
				}
			}
		}
	}
}

etf_oob_effect = { # "Order of Battle" - Scale down/up starting armies
	# "Too many" of a certain unit type
	every_province = {
		limit = {
			OR = {
				num_of_units_in_province = {
					type = infantry
					who = controller
					amount = 26
				}
				num_of_units_in_province = {
					type = cavalry
					who = controller
					amount = 6
				}
				num_of_units_in_province = {
					type = artillery
					who = controller
					amount = 11
				}
			}
		}
		while = {
			limit = {
				num_of_units_in_province = {
					type = infantry
					who = controller
					amount = 26
				}
			}
			kill_units = {
				type = infantry
				who = controller
				amount = 1
			}
		}
		while = {
			limit = {
				num_of_units_in_province = {
					type = cavalry
					who = controller
					amount = 6
				}
			}
			kill_units = {
				type = cavalry
				who = controller
				amount = 1
			}
		}
		while = {
			limit = {
				num_of_units_in_province = {
					type = artillery
					who = controller
					amount = 11
				}
			}
			kill_units = {
				type = artillery
				who = controller
				amount = 1
			}
		}
	}
	# Give Transports
	if = {
		limit = {
			variable_arithmetic_trigger = {
				export_to_variable = {
					which = free_forcelimit_var
					value = trigger_value:naval_forcelimit
				}
				export_to_variable = {
					which = navy_size_var
					value = trigger_value:navy_size
				}
				
				subtract_variable = { # naval_forcelimit - navy_size
					which = free_forcelimit_var
					which = navy_size_var
				}
				check_variable = {
					which = free_forcelimit_var
					value = 80
				}
			}
		}
		random_owned_province = {
			limit = {
				transports_in_province = 1
				NOT = { transports_in_province = 60 }
			}
			while = {
				limit = {
					owner = {
						NOT = { navy_size_percentage = 1 }
					}
					NOT = { transports_in_province = 60 }
				}
				transport = owner
			}
		}
	}
}

# Province-scope, FROM = Previous owner, controller = New owner
cede_on_occupation_effect = {
	if = {
		limit = {
			has_province_flag = was_owned_by_@controller
		}
		cede_province = controller
		clr_province_flag = was_owned_by_@controller
		clr_province_flag = province_is_occupied
	}
	else_if = {
		limit = {
			controller = {
				has_country_flag = provinces_should_flip
			}
			NOT = { is_capital_of = FROM }
		}
		cede_province = controller
		#if = { limit = { is_claim = controller } remove_claim = controller }
		if = {
			limit = {
				NOT = { is_core = controller }
			}
			add_territorial_core = controller
		}
		if = {
			limit = {
				NOT = { has_province_flag = province_is_occupied }
			}
			set_province_flag = was_owned_by_@FROM
		}
		set_province_flag = province_is_occupied
	}
}

doctrine_of_lapse_effect = {
	if = {
		limit = {
			is_princely_state_trigger = yes
			has_heir = no
			ai = yes
			overlord = {
				is_master_of_india_trigger = yes
			}
			is_year = 1700
			NOT = { started_in = 1936.1.1 }
		}
		random = {
			chance = 50
			overlord = {
				country_event = { id = etf_event_india.101 }
			}
		}
	}
}

cede_province_claim_and_core = {
	if = {
		limit = {
			is_core = owner
		}
		remove_core = owner
		add_core = $who$
	}
	if = {
		limit = {
			is_permanent_claim = owner
		}
		remove_claim = owner
		add_permanent_claim = $who$
	}
	if = {
		limit = {
			is_claim = owner
		}
		remove_claim = owner
		add_claim = $who$
	}
	cede_province = $who$
}

# province
# FROM = old owner
colony_eat_colonies_effect = {
	# Triggered by 'on_province_owner_change'.
	# If owner is overlord of certain colonial tags and receives provinces in a given region,
	# they should be transferred to the colony.
	if = {
		limit = {
			is_city = yes
			owner = {
				any_subject_country = {
					OR = {
						country_is = { tag = RHJ }
						country_is = { tag = EIC }
						country_is = { tag = NTE }
						country_is = { tag = QLD }
						country_is = { tag = NSW }
						country_is = { tag = SSA }
						country_is = { tag = WAU }
						country_is = { tag = HBC }
					}
				}
			}
		}
		# East India Company / Raj
		if = {
			limit = {
				owner = {
					NOT = {
						OR = {
							country_is = { tag = RHJ }
							country_is = { tag = EIC }
						}
					}
				}
				raj_india_trigger = yes
			}
			owner = {
				if = {
					limit = {
						any_subject_country = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = RHJ }
							NOT = { tag = FROM }
						}
					}
					random_subject_country = {
						limit = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = RHJ }
							NOT = { tag = FROM }
						}
						ROOT = {
							cede_province_claim_and_core = { who = PREV }
						}
					}
				}
				else_if = {
					limit = {
						any_subject_country = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = EIC }
							NOT = { tag = FROM }
						}
					}
					random_subject_country = {
						limit = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = EIC }
							NOT = { tag = FROM }
						}
						ROOT = {
							cede_province_claim_and_core = { who = PREV }
						}
					}
				}
			}
		}
		# Australian Sub-colonies
		else_if = {
			limit = {
				owner = {
					NOT = {
						OR = {
							country_is = { tag = NTE }
							country_is = { tag = QLD }
							country_is = { tag = NSW }
							country_is = { tag = SSA }
							country_is = { tag = WAU }
							country_is = { tag = AUS }
						}
					}
				}
				region = australia_region
			}
			if = {
				limit = {
					top_end_trigger = yes
				}
				owner = {
					random_subject_country = {
						limit = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = NTE }
							NOT = { tag = FROM }
						}
						ROOT = {
							cede_province_claim_and_core = { who = PREV }
						}
					}
				}
			}
			else_if = {
				limit = {
					queensland_trigger = yes
				}
				owner = {
					random_subject_country = {
						limit = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = QLD }
							NOT = { tag = FROM }
						}
						ROOT = {
							cede_province_claim_and_core = { who = PREV }
						}
					}
				}
			}
			else_if = {
				limit = {
					new_south_wales_trigger = yes
				}
				owner = {
					random_subject_country = {
						limit = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = NSW }
							NOT = { tag = FROM }
						}
						ROOT = {
							cede_province_claim_and_core = { who = PREV }
						}
					}
				}
			}
			else_if = {
				limit = {
					south_australia_trigger = yes
				}
				owner = {
					random_subject_country = {
						limit = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = SSA }
							NOT = { tag = FROM }
						}
						ROOT = {
							cede_province_claim_and_core = { who = PREV }
						}
					}
				}
			}
			else_if = {
				limit = {
					western_australia_trigger = yes
				}
				owner = {
					random_subject_country = {
						limit = {
							is_subject_other_than_tributary_trigger = yes
							country_is = { tag = WAU }
							NOT = { tag = FROM }
						}
						ROOT = {
							cede_province_claim_and_core = { who = PREV }
						}
					}
				}
			}
		}
		# Hudson Bay Company
		else_if = {
			limit = {
				owner = {
					NOT = {
						OR = {
							country_is = { tag = HBC }
						}
					}
				}
				region = hudson_bay_region
			}
			owner = {
				random_subject_country = {
					limit = {
						is_subject_other_than_tributary_trigger = yes
						country_is = { tag = HBC }
						NOT = { tag = FROM }
					}
					ROOT = {
						cede_province_claim_and_core = { who = PREV }
					}
				}
			}
		}
	}
}

country_released_effect = {
	[[original] $original$ = { save_event_target_as = original_country } ]
	[[released] $released$ = { save_event_target_as = released_country } ]
	if = {
		limit = {
			has_saved_event_target = original_country
			has_saved_event_target = released_country
		}
		if = {
			limit = {
				event_target:original_country = {
					exists = yes
					NOT = { tag = event_target:released_country }
				}
			}
			# Adopt reforms from original country:
			event_target:original_country = {
				# Government:
				trigger_switch = {
					on_trigger = government
					monarchy = {
						event_target:released_country = { change_government = monarchy }
					}
					republic = {
						event_target:released_country = { change_government = republic }
					}
					theocracy = {
						event_target:released_country = { change_government = theocracy }
					}
				}
				# Parliamentary System:
				trigger_switch = {
					on_trigger = has_reform
					elected_parliament = {
						event_target:released_country = {
							add_government_reform = parliamentary_reform
							add_government_reform = elected_parliament
						}
					}
					landed_parliament = {
						event_target:released_country = {
							add_government_reform = parliamentary_reform
							add_government_reform = landed_parliament
						}
					}
					appointed_parliament = {
						event_target:released_country = {
							add_government_reform = parliamentary_reform
							add_government_reform = appointed_parliament
						}
					}
					authoritarian_rule = {
						event_target:released_country = { add_government_reform = authoritarian_rule }
					}
				}
				# Royal Power:
				trigger_switch = {
					on_trigger = has_reform
					ceremonial_monarch = {
						event_target:released_country = { add_government_reform = ceremonial_monarch }
					}
					ministrial_dictatorship = {
						event_target:released_country = { add_government_reform = ministrial_dictatorship }
					}
					royal_power = {
						event_target:released_country = { add_government_reform = royal_power }
					}
				}
				# Political Party System:
				trigger_switch = {
					on_trigger = has_reform
					direct_democracy_system = {
						event_target:released_country = { add_government_reform = direct_democracy_system }
					}
					multi_party_system = {
						event_target:released_country = { add_government_reform = multi_party_system }
					}
					two_party_system = {
						event_target:released_country = { add_government_reform = multi_party_system } # intentional
					}
					single_party_system = {
						event_target:released_country = { add_government_reform = single_party_system }
					}
					dictatorial_rule = {
						event_target:released_country = { add_government_reform = dictatorial_rule }
					}
					totalitarian_rule = {
						event_target:released_country = { add_government_reform = totalitarian_rule }
					}
				}
				# Ideology:
				trigger_switch = {
					on_trigger = has_reform
					democracy_reform = {
						event_target:released_country = { add_government_reform = democracy_reform }
					}
					oligarchic_reform = {
						event_target:released_country = { add_government_reform = oligarchic_reform }
					}
					military_government = {
						event_target:released_country = { add_government_reform = military_government }
					}
					islamist_government = {
						event_target:released_country = { add_government_reform = islamist_government }
					}
					communist_government = {
						event_target:released_country = { add_government_reform = communist_government }
					}
					fascist_government = {
						event_target:released_country = { add_government_reform = fascist_government }
					}
					anarchist_society = {
						event_target:released_country = { add_government_reform = anarchist_society }
					}
				}
				# Religion:
				if = {
					limit = {
						religion = secularism
					}
					event_target:released_country = {
						change_religion = secularism
					}
				}
			}
		}
		event_target:released_country = {
			if = {
				limit = {
					tag = LTS
					government = monarchy
				}
				add_government_reform = principality_title_reform
				set_dynasty = "von Liechtenstein"
			}
			if = {
				limit = {
					tag = SIG
					government = monarchy
				}
				add_government_reform = principality_title_reform
				set_dynasty = "von Hohenzollern"
			}
			if = {
				limit = {
					tag = CEH
					government = republic
					capital_scope = {
						religion_group = muslim
					}
					event_target:original_country = {
						primary_culture = russian
					}
					is_year = 2000
				}
				change_religion = sunni
				add_government_reform = islamic_republic_reform
				define_ruler = {
					name = "Ramzan Kadyrov"
					age = 45
					adm = 3
					dip = 1
					mil = 2
				}
			}
			
			if = {
				limit = {
					event_target:original_country = {
						is_civilized = yes
					}
				}
				become_civilized_effect = yes
			}
			catch_up_on_reforms_effect = yes
			change_variable = {
				which = industry_score
				value = 0
			}
			# capital_scope = {
				# add_province_modifier = {
					# name = seat_of_government_modifier
					# duration = -1
				# }
			# }
		}
	}
}

#chinese_cores_effect = {
#	hidden_effect = {
#		every_province = {
#			limit = {
#				OR = {
#					superregion = china_superregion
#					any_core_country = {
#						OR = {
#							is_emperor_of_china = yes
#							country_is = { tag = CHN }
#						}
#					}
#				}
#			}
#			# Purge old Dynasties and Tribes
#			every_country_including_inactive = {
#				limit = {
#					capital_scope = {
#						OR = {
#							superregion = china_superregion
#							any_core_country = {
#								OR = {
#									is_emperor_of_china = yes
#									country_is = { tag = CHN }
#								}
#							}
#						}
#					}
#					exists = no
#				}
#				PREV = {
#					remove_core = PREV
#				}
#			}
#			# Add Revolter tags
#			if = { limit = { NOT = { exists = FRM } area = taiwan_area 			  } add_core = FRM } # Formosa
#			if = { limit = { NOT = { exists = KAI } xinjiang_trigger 		= yes } add_core = KAI } # East Turkestan
#			if = { limit = { NOT = { exists = KHA } mongolia_trigger 		= yes } add_core = KHA } # Mongolia
#			if = { limit = { NOT = { exists = MCK } inner_manchuria_trigger = yes } add_core = MCH } # Manchuria
#			if = { limit = { NOT = { exists = MCK } outer_manchuria_trigger = yes } add_core = MCH } # Outer Manchuria
#			if = { limit = { NOT = { exists = MJG } inner_mongolia_trigger 	= yes } add_core = MJG } # Inner Mongolia
#			if = { limit = { NOT = { exists = TIB } tibet_trigger 			= yes } add_core = TIB } # Tibet
#			if = { limit = { NOT = { exists = TTU } province_id = 1066 			  } add_core = TTU } # Altai Uriankhai
#			if = { limit = { NOT = { exists = TTU } province_id = 716 			  } add_core = TTU } # Tannu Tuva
#			#if = { limit = { QNG = { is_emperor_of_china = yes } superregion = china_superregion } add_core = MNG } # Ming Restorationists
#			# Add Clique tags
#			if = {
#				limit = {
#					has_global_flag = the_warlords_era
#				}
#				if = { limit = { anhui_trigger 		= yes } add_core = AUI } # Anhui
#				if = { limit = { fujian_trigger 	= yes } add_core = FJN } # Fujian
#				if = { limit = { guangdong_trigger 	= yes } add_core = GDG } # Guangdong
#				if = { limit = { guangxi_trigger 	= yes } add_core = GXI } # Guangxi
#				if = { limit = { hubei_trigger 		= yes } add_core = HBE } # Hubei
#				if = { limit = { hunan_trigger 		= yes } add_core = HNN } # Hunan
#				if = { limit = { ma_clique_trigger 	= yes } add_core = MCL } # Ma Clique
#				if = { limit = { shanxi_trigger 	= yes } add_core = SHX } # Shanxi
#				if = { limit = { sichuan_trigger 	= yes } add_core = SCC } # Sichuan
#				if = { limit = { xinjiang_trigger 	= yes } add_core = XJG } # Xinjiang
#				if = { limit = { yunnan_trigger 	= yes } add_core = YNA } # Yunnan
#				if = { limit = { zhili_trigger 		= yes } add_core = ZHI } # Zhili
#				if = { limit = { is_core = MCH } add_core = FEN remove_core = MCH } # Fengtian
#			}
#		}
#	}
#}

update_main_religion_variable_effect = {
	hidden_effect = {
		change_variable = { # variable init
			which = main_religion
			value = 0
		}
	}
	if = {
		limit = {
			NOT = { religion = secularism }
		}
		export_to_variable = {
			which = main_religion
			value = religion
		}
	}
	else = {
		if = {
			limit = {
				is_colonial_subject_type = yes
			}
			set_variable = {
				which = main_religion
				which = overlord
			}
		}
		else_if = {
			limit = {
				capital_scope = {
					OR = {
						has_owner_culture = yes
						has_owner_accepted_culture = yes
					}
				}
			}
			capital_scope = {
				PREV = {
					export_to_variable = {
						which = main_religion
						value = religion
						who = PREV
					}
				}
			}
		}
		else = {
			export_to_variable = {
				which = main_religion
				value = dominant_religion
			}
		}
	}
}

fix_secular_ruler_religion_effect = {
	if = {
		limit = {
			is_lesser_in_union = no
		}
		if = {
			limit = {
				ruler_religion = secularism
			}
			if = { # If country has State Atheism, ruler becomes atheist.
				limit = {
					has_country_modifier = state_atheism
				}
				set_ruler_religion = irreligious
			}
			else = {
				set_ruler_religion = variable:main_religion
			}
		}
		if = {
			limit = {
				has_heir = yes
				heir_religion = secularism
			}
			if = { # If country has State Atheism, heir becomes atheist.
				limit = {
					has_country_modifier = state_atheism
				}
				set_heir_religion = irreligious
			}
			else = {
				set_heir_religion = variable:main_religion
			}
		}
		if = {
			limit = {
				has_consort = yes
				consort_religion = secularism
			}
			if = { # If country has State Atheism, consort becomes atheist.
				limit = {
					has_country_modifier = state_atheism
				}
				set_consort_religion = irreligious
			}
			else = {
				set_consort_religion = variable:main_religion
			}
		}
	}
}

fix_colonial_ruler_culture_effect = {
	if = {
		limit = {
			is_colonial_nation = no
			colonial_parent = { # Weird bug where post-colonial countries get a ruler of their former overlord's culture.
				PREV = {
					ruler_culture = PREV
				}
			}
		}
		set_ruler_culture = new_variable:primary_culture # This fixes this.
	}
	if = {
		limit = {
			has_heir = yes
			has_foreign_heir = no
			
			is_colonial_nation = no
			colonial_parent = {
				PREV = {
					heir_culture = PREV
				}
			}
		}
		set_heir_culture = new_variable:primary_culture
	}
	if = {
		limit = {
			has_consort = yes
			has_foreign_consort = no
			
			is_colonial_nation = no
			colonial_parent = {
				PREV = {
					consort_culture = PREV
				}
			}
		}
		set_consort_culture = new_variable:primary_culture
	}
}

# add_late_age_province_modifiers_effect = {
	# if = {
		# limit = {
			# OR = {
				# AND = {
					# current_age = industrial_age
					# any_province = {
						# NOT = { has_province_modifier = industrial_age_province_modifier }
					# }
				# }
				# AND = {
					# current_age = great_war_age
					# any_province = {
						# NOT = { has_province_modifier = great_war_age_province_modifier }
					# }
				# }
				# AND = {
					# current_age = information_age
					# any_province = {
						# NOT = { has_province_modifier = information_age_province_modifier }
					# }
				# }
			# }
		# }
		# every_province = {
			# remove_province_modifier = industrial_age_province_modifier
			# remove_province_modifier = great_war_age_province_modifier
			# remove_province_modifier = information_age_province_modifier
			# if = {
				# limit = {
					# current_age = industrial_age
				# }
				# add_permanent_province_modifier = {
					# name = industrial_age_province_modifier
					# duration = -1
					# desc = until_end_of_age_desc
				# }
			# }
			# else_if = {
				# limit = {
					# current_age = great_war_age
				# }
				# add_permanent_province_modifier = {
					# name = great_war_age_province_modifier
					# duration = -1
					# desc = until_end_of_age_desc
				# }
			# }
			# else_if = {
				# limit = {
					# current_age = information_age
				# }
				# add_permanent_province_modifier = {
					# name = information_age_province_modifier
					# duration = -1
					# desc = until_end_of_age_desc
				# }
			# }
		# }
	# }
# }

update_tag_color_and_name_effect = {
	# Update tag to any available/suitable alias
	update_country_tag_alias = yes
	
	# Update country color
	subject_has_overlord_color_effect = yes
	
	# Update country name
	update_dynamic_country_name = yes
	
	# Update other stuff
	update_tag_data_effect = yes
	
	# log = update_tag_color_and_name_effect_log_tt
}